# MailDT - Mail Delivery Monitor

![MailDT Logo](static/img/logo.svg)

MailDT is a robust, self-hosted mail delivery monitoring tool designed to verify the reliability and latency of your email infrastructure. It performs "loopback" testing by sending unique probes via SMTPS and watching for their arrival via IMAPS.

## üöÄ Features

- **Round-Trip Monitoring**: Sends emails with unique GUIDs and verifies arrival.
- **Multi-Recipient Support**: Monitor multiple target mailboxes simultaneously.
- **Granular Configuration**: Set individual send intervals and alert thresholds per recipient.
- **Modern Dashboard**: Real-time live monitor with color-coded status, icons, and auto-refresh.
- **Delivery History**: Detailed logs for each recipient with up to 7 days of retention.
- **Smart Alerting**: 
    - Notifications via **Discord Webhooks** and **Email**.
    - Independent toggles for alert channels per recipient.
    - Alert on **Missing** emails (threshold exceeded).
    - Alert on **Send Failures** (SMTP errors).
    - **Recovery** notifications when delayed emails finally arrive.
- **Security First**:
    - **2FA (TOTP)** support for login.
    - Password masking in the web interface.
    - Secure session-based authentication.
- **Docker Ready**: Fully configurable via environment variables.
- **Offline Capable**: All CSS, JS, and Font assets are served locally from the container.
- **Reverse Proxy Support**: Easy configuration for Nginx, Traefik, etc., with a single flag.

## üõ†Ô∏è Setup & Installation

### 1. Prerequisites
- Docker and Docker Compose installed.
- A dedicated mail account for monitoring (SMTP and IMAP access).

### 2. Configuration
Copy the example environment file and fill in your credentials:

```bash
cp .env.example .env
```

**Key Environment Variables:**
- `SMTP_HOST` / `IMAP_HOST`: Your mail server addresses.
- `ADMIN_USER` / `ADMIN_PASSWORD`: Credentials for the web UI.
- `ADMIN_TOTP_SECRET`: (Optional) Base32 secret for 2FA.
- `ENABLE_PROXY`: Set to `true` if running behind a reverse proxy.
- `DISCORD_WEBHOOK_URL`: (Optional) For Discord notifications.

### 3. Start the Application
```bash
docker-compose up -d --build
```

Access the dashboard at `http://localhost:5000`.

## üñ•Ô∏è Screenshots

- **Dashboard**: View the current health of all monitored recipients.
- **Recipients**: Manage target addresses and individual settings.
- **History**: Analyze delivery latency trends with the built-in log viewer.

## üì¶ Tech Stack
- **Backend**: Python (Flask)
- **Database**: PostgreSQL / SQLAlchemy
- **Task Runner**: APScheduler
- **Frontend**: Bootstrap (Zephyr Theme), FontAwesome
- **Messaging**: `smtplib`, `imaplib`

## üßπ Maintenance
The system automatically cleans up delivery history records older than 7 days every 24 hours to keep the database lightweight.

---
Generated by Gemini CLI Agent.