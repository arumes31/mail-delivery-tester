# MailDT - Mail Delivery Monitor

![MailDT Logo](static/img/logo.svg)

MailDT is a robust, self-hosted mail delivery monitoring tool designed to verify the reliability, latency, and authentication health of your email infrastructure. It performs "loopback" testing by sending unique probes via SMTP and watching for their arrival via IMAP.

## üöÄ Features

- **Round-Trip Monitoring**: Automated probes to track **RTT (Round Trip Time)** and delivery reliability.
- **Enhanced Live Monitor**: Real-time dashboard showing status, RTT, and **SPF/DKIM/DMARC** results.
- **üõ°Ô∏è Privacy & Public Access**: 
    - **Email Masking**: Recipient addresses are automatically masked for unauthenticated users.
    - **Public Tools**: Mail Tester and SMTP Diagnostics are accessible without login.
- **üß™ Mail Tester**: diagnostic tool (similar to mail-tester.com) to manually verify SPF, DKIM, DMARC, and detailed spam headers (O365, Mimecast, Proofpoint, etc.).
- **ü©∫ SMTP Diagnostics**: Public protocol analyzer with session transcripts, banner checks, TLS verification, and open relay testing.
- **Multi-Recipient Support**: Monitor multiple target mailboxes simultaneously with individual schedules.
- **Smart Alerting**: 
    - Notifications via **Discord Webhooks** and **Email**.
    - Alert on **Missing** emails, **Send Failures**, and **Service Recovery**.
- **Resilient Infrastructure**:
    - **PostgreSQL 17**: High-performance persistence with host-mapped volume.
    - **Smart DNS**: Multi-provider DNS resolution with Google DNS fallback for reliable PTR lookups.
    - **Rate Limiting**: IP-based protection (5 tests/min) with live countdown timers for public tools.
- **Security**: **2FA (TOTP)** support for admin access and secure session management.

## üõ†Ô∏è Setup & Installation

### 1. Prerequisites
- Docker and Docker Compose installed.
- A dedicated mail account for monitoring (SMTP and IMAP access).

### 2. Configuration
Copy the example environment file and fill in your credentials:

```bash
cp .env.example .env
```

**Key Environment Variables:**
- `SMTP_HOST` / `IMAP_HOST`: Your mail server addresses.
- `DB_USER` / `DB_PASS` / `DB_NAME`: PostgreSQL credentials.
- `ADMIN_USER` / `ADMIN_PASSWORD`: Credentials for the web UI.
- `ENABLE_PROXY`: Set to `true` if running behind a reverse proxy.

### 3. Start the Application
```bash
docker-compose up -d --build
```

Access the dashboard at `http://localhost:5000`. Persistent data will be stored in the `./data` folder on your host.

## üñ•Ô∏è Navigation

- **Live Monitor**: Publicly viewable health and authentication status (masked emails).
- **Mail Tester**: Public manual verification of mail headers and spam scores.
- **SMTP Diagnostics**: Public deep protocol analysis and session transcripts.
- **System Diagnostics**: (Admin) Internal health check of your configured SMTP/IMAP credentials.
- **Recipients**: (Admin) Manage target addresses and alert thresholds.

## üì¶ Tech Stack
- **Backend**: Python (Flask)
- **Database**: PostgreSQL 17 / SQLAlchemy
- **Diagnostics**: `dnspython`, `socket`
- **Frontend**: Bootstrap 5 (Zephyr), FontAwesome 6
- **Messaging**: `smtplib`, `imaplib`

---
Generated by Gemini CLI Agent.