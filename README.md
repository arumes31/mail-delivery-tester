# MailDT - Mail Delivery Monitor

<p align="center">
  <img src="static/img/logo.svg" width="120" alt="MailDT Logo">
</p>

MailDT is a robust, self-hosted mail delivery monitoring tool designed to verify the reliability, latency, and authentication health of your email infrastructure. It performs "loopback" testing by sending unique probes via SMTP and watching for their arrival via IMAP.

## ğŸš€ Features

- **Round-Trip Monitoring**: Automated probes to track **RTT (Round Trip Time)** and delivery reliability.
- **Enhanced Live Monitor**: Real-time dashboard showing status, RTT, and **SPF/DKIM/DMARC** results.
- **ğŸ“Š Sidebar Analytics**: Persistent, real-time widget showing mail and tool usage stats for the last hour, 24h, and all-time.
- **ğŸ¨ Cyber-Purple Aesthetic**: Permanent dark mode with a modern purple/indigo palette, neon accents, and a dynamic SVG mesh background.
- **ğŸ›¡ï¸ Privacy & Public Access**: 
    - **Email Masking**: Recipient addresses are automatically masked for unauthenticated users.
    - **Public Tools**: Mail Tester, SMTP Diagnostics, and Blacklist Check are accessible without login.
- **ğŸ§ª Mail Tester**: Diagnostic tool (similar to mail-tester.com) to manually verify SPF, DKIM, DMARC, and detailed spam headers (O365, Mimecast, Proofpoint, etc.).
- **ğŸ©º SMTP Diagnostics**: Public protocol analyzer with session transcripts, banner checks, TLS verification, and open relay testing.
- **ğŸ›¡ï¸ Blacklist Check**: Deep DNSBL analysis for domains and their MX nodes against 15+ major providers.
- **ğŸ” Decode Spam Headers**: Integrated official engine for analyzing 67+ raw email header types.
- **ğŸ” WHOIS Lookup**: Embedded integration for external domain and IP information.
- **ğŸŒ Web-Check**: Integrated OSINT tool for comprehensive website analysis.
- **Multi-Recipient Support**: Monitor multiple target mailboxes simultaneously with individual schedules.
- **Smart Alerting**: 
    - Notifications via **Discord Webhooks** and **Email**.
    - Alert on **Missing** emails, **Send Failures**, and **Service Recovery**.
- **Resilient Infrastructure**:
    - **PostgreSQL 17**: High-performance persistence with host-mapped volume.
    - **Persistent Metrics**: Global counters and event logging ensure statistics survive data cleanups and recipient deletions.
    - **Smart DNS**: Multi-provider DNS resolution with Google DNS fallback for reliable PTR lookups.
    - **Performance**: Intelligent 120s caching for public users with real-time bypass for admins.
- **Security**: **2FA (TOTP)** support for admin access and IP-based rate limiting across all diagnostic tools.

## ğŸ› ï¸ Setup & Installation

### 1. Prerequisites
- Docker and Docker Compose installed.
- A dedicated mail account for monitoring (SMTP and IMAP access).

### 2. Configuration
Copy the example environment file and fill in your credentials:

```bash
cp .env.example .env
```

**Key Environment Variables:**
- `SMTP_HOST` / `IMAP_HOST`: Your mail server addresses.
- `DB_USER` / `DB_PASS` / `DB_NAME`: PostgreSQL credentials.
- `ADMIN_USER` / `ADMIN_PASSWORD`: Credentials for the web UI.
- `ENABLE_PROXY`: Set to `true` if running behind a reverse proxy.

### 3. Start the Application
```bash
docker-compose up -d --build
```

Access the dashboard at `http://localhost:5000`. Persistent data will be stored in the `./data` folder on your host.

## ğŸ–¥ï¸ Navigation

- **Live Monitor**: Publicly viewable health and authentication status (masked emails).
- **Mail Tester**: Public manual verification of mail headers and spam scores.
- **SMTP Diagnostics**: Public deep protocol analysis and session transcripts.
- **Blacklist Check**: Public reputation scanning for domains and IPs.
- **Decode Spam Headers**: Deep analysis of raw email headers.
- **WHOIS Lookup**: Public embedded WHOIS information service.
- **Web-Check**: Public embedded website analysis tool.
- **System Diagnostics**: (Admin) Internal health check of your configured SMTP/IMAP credentials.
- **Recipients**: (Admin) Manage target addresses and alert thresholds.

## ğŸ“¦ Tech Stack
- **Backend**: Python (Flask)
- **Database**: PostgreSQL 17 / SQLAlchemy
- **Diagnostics**: `dnspython`, `socket`
- **Frontend**: Bootstrap 5 (Dark), FontAwesome 6, Custom Cyber-Purple CSS
- **Messaging**: `smtplib`, `imaplib`

---
Generated by Gemini CLI Agent.